<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="manifest" href="manifest.json">
    <title>MTG Sim√≥n Commander Pro</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <style>
        body {
            background-color: #0d0d0d;
            background-image: url('fondo.jpg');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            color: #e0e0e0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0;
            padding: 15px 10px;
            min-height: 100vh;
            box-sizing: border-box;
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            z-index: -1;
        }

        .main-container {
            width: 100%;
            max-width: 450px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .players-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            width: 100%;
        }

        .player-card {
            background: rgba(0, 0, 0, 0.85);
            padding: 12px 5px;
            border-radius: 15px;
            text-align: center;
            border: 1px solid rgba(212, 175, 55, 0.4);
            min-width: 0;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .life-value {
            font-size: 42px;
            font-weight: bold;
            color: #d4af37;
            margin: 5px 0;
            display: block;
        }

        .life-controls {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 3px;
            margin-bottom: 10px;
            padding: 0 4px;
        }

        .btn-life {
            width: 100%;
            height: 30px;
            border-radius: 6px;
            border: none;
            font-weight: bold;
            font-size: 10px;
            cursor: pointer;
            background: #333;
            color: white;
        }

        .player-name {
            font-size: 10px;
            text-transform: uppercase;
            color: #ccc;
            border: none;
            background: transparent;
            text-align: center;
            width: 100%;
            margin-bottom: 5px;
        }

        .extra-counters {
            display: flex;
            justify-content: space-around;
            padding-top: 8px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            width: 100%;
        }

        .counter-box {
            font-size: 13px;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2px;
        }

        /* AJUSTE DE CONTROLES SUPERIORES (DADO, JUGADORES, D√çA/NOCHE) */
        .player-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: bold;
            padding: 5px 10px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 12px;
        }

        .btn-trans {
            background: transparent;
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            border-radius: 5px;
            width: 30px;
            height: 30px;
            cursor: pointer;
            font-size: 18px;
        }

        .mana-section {
            background: rgba(0, 0, 0, 0.85);
            padding: 10px;
            border-radius: 20px;
            width: 100%;
            box-sizing: border-box;
        }

        .mana-pool {
            display: flex;
            justify-content: center;
            gap: 8px;
            width: 100%;
        }

        .mana-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
        }

        .mana-btn {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            border: 1px solid #fff;
            cursor: pointer;
        }

        .mana-val { font-weight: bold; font-size: 12px; }
        .w { background: #f9faf4; }
        .u { background: #0e68ab; }
        .b { background: #151110; }
        .r { background: #d32f2f; }
        .g { background: #228b22; }
        .c { background: #7f8c8d; } /* Color Incoloro */
        .storm {
            background: #8e44ad;
            border: none;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
        }

        .side-icon {
            font-size: 22px;
            cursor: pointer;
            text-align: center;
        }

        .sound-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            width: 100%;
        }

        .btn-magic {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px 2px;
            font-size: 10px;
            border-radius: 10px;
            border: none;
            color: white;
            cursor: pointer;
            font-weight: bold;
            text-shadow: 1px 1px 2px black;
            gap: 4px;
        }

        .c1 { background: #2d5a27; } .c2 { background: #a03023; } .c3 { background: #20547c; }
        .c4 { background: #3d3d3d; } .c5 { background: #b7950b; } .c6 { background: #117a65; }
        .c7 { background: #6c3483; } .c8 { background: #a04000; } .c9 { background: #2874a6; }
        .c10 { background: #1e8449; } .c11 { background: #922b21; } .c12 { background: #d4ac0d; color: black; text-shadow: none; }
        .c13 { background: #1a5276; } .c14 { background: #7b241c; } .c15 { background: #1d8348; }

        .reset-btn {
            background: #d4af37;
            color: black;
            font-weight: bold;
            padding: 15px;
            border-radius: 10px;
            border: none;
            cursor: pointer;
            width: 100%;
            margin-top: 10px;
        }

        .peligro {
            animation: parpadeo 1.5s infinite;
            border-color: #ff4444 !important;
        }

        @keyframes parpadeo {
            0% { background: rgba(0, 0, 0, 0.85); }
            50% { background: rgba(100, 0, 0, 0.7); }
            100% { background: rgba(0, 0, 0, 0.85); }
        }

        .monarca-active {
            border: 2px solid #d4af37;
            box-shadow: 0 0 15px #d4af37;
        }
    </style>
</head>

<body>
    <div class="overlay"></div>
    <div class="main-container">
        <h2 style="color: #d4af37; text-align: center; letter-spacing: 2px; margin: 0;">MTG SIM√ìN PRO</h2>

        <div class="players-container" id="player-area"></div>

        <div class="player-controls">
            <div class="side-icon" onclick="rollD20()">üé≤</div>
            <div>
                <button class="btn-trans" onclick="removePlayer()">-</button>
                <span style="font-size: 12px; margin: 0 10px;">JUGADORES</span>
                <button class="btn-trans" onclick="addPlayer()">+</button>
            </div>
            <div class="side-icon" id="day-night-toggle" onclick="toggleDayNight()">‚òÄÔ∏è</div>
        </div>

        <div class="mana-section">
            <div class="mana-pool">
                <div class="mana-item" onclick="changeMana('w',1)" oncontextmenu="changeMana('w',-1);return false;"><div class="mana-btn w"></div><span class="mana-val" id="mw">0</span></div>
                <div class="mana-item" onclick="changeMana('u',1)" oncontextmenu="changeMana('u',-1);return false;"><div class="mana-btn u"></div><span class="mana-val" id="mu">0</span></div>
                <div class="mana-item" onclick="changeMana('b',1)" oncontextmenu="changeMana('b',-1);return false;"><div class="mana-btn b"></div><span class="mana-val" id="mb">0</span></div>
                <div class="mana-item" onclick="changeMana('r',1)" oncontextmenu="changeMana('r',-1);return false;"><div class="mana-btn r"></div><span class="mana-val" id="mr">0</span></div>
                <div class="mana-item" onclick="changeMana('g',1)" oncontextmenu="changeMana('g',-1);return false;"><div class="mana-btn g"></div><span class="mana-val" id="mg">0</span></div>
                <div class="mana-item" onclick="changeMana('c',1)" oncontextmenu="changeMana('c',-1);return false;"><div class="mana-btn c"></div><span class="mana-val" id="mc">0</span></div>
                <div class="mana-item" onclick="changeStorm(1)" oncontextmenu="changeStorm(-1);return false;"><div class="mana-btn storm">‚õàÔ∏è</div><span class="mana-val" id="st-val">0</span></div>
            </div>
        </div>

        <div class="sound-grid">
            <button class="btn-magic c1" onclick="play('rugido')"><span>ü¶ñ</span> Criatura</button>
            <button class="btn-magic c2" onclick="play('fuego')"><span>üî•</span> Fuego</button>
            <button class="btn-magic c3" onclick="play('counter')"><span>‚õî</span> Counter</button>
            <button class="btn-magic c4" onclick="play('muerte')"><span>üíÄ</span> Morir</button>
            <button class="btn-magic c5" onclick="play('barremesas')"><span>‚ú®</span> Barrer</button>
            <button class="btn-magic c6" onclick="play('proliferar')"><span>üß™</span> Proliferar</button>
            <button class="btn-magic c7" onclick="play('cementerio')"><span>‚ö∞Ô∏è</span> Cementerio</button>
            <button class="btn-magic c8" onclick="play('mano')"><span>üÉè</span> Devolver</button>
            <button class="btn-magic c9" onclick="play('buscar')"><span>üîç</span> Buscar</button>
            <button class="btn-magic c10" onclick="play('lobos')"><span>üê∫</span> Lobos</button>
            <button class="btn-magic c11" onclick="play('turno')"><span>‚è≥</span> Turno</button>
            <button class="btn-magic c12" onclick="play('curar')"><span>üíñ</span> Curar</button>
            <button class="btn-magic c13" onclick="play('zombies')"><span>üßü</span> Zombies</button>
            <button class="btn-magic c14" onclick="play('cry')"><span>üò¢</span> Cry</button>
            <button class="btn-magic c15" onclick="play('barajar')"><span>üîÑ</span> Barajar</button>
        </div>

        <button class="reset-btn" onclick="resetGame()">REINICIAR PARTIDA</button>
    </div>

    <script>
        let players = [
            { name: "JUGADOR 1", life: 40, cmd: 0, poison: 0, monarca: false },
            { name: "JUGADOR 2", life: 40, cmd: 0, poison: 0, monarca: false }
        ];
        let mana = { w: 0, u: 0, b: 0, r: 0, g: 0, c: 0 };
        let storm = 0;
        let isDay = true;

        function updateUI() {
            const area = document.getElementById('player-area');
            area.innerHTML = players.map((p, i) => `
                <div class="player-card ${p.life <= 10 ? 'peligro' : ''} ${p.monarca ? 'monarca-active' : ''}">
                    <input class="player-name" value="${p.name}" onchange="updateName(${i}, this.value)">
                    <span class="life-value">${p.life}</span>
                    <div class="life-controls">
                        <button class="btn-life" onclick="changeLife(${i},-10)">-10</button>
                        <button class="btn-life" onclick="changeLife(${i},-1)">-1</button>
                        <button class="btn-life" onclick="changeLife(${i},1)">+1</button>
                        <button class="btn-life" onclick="changeLife(${i},10)">+10</button>
                    </div>
                    <div class="extra-counters">
                        <div class="counter-box" onclick="changeExtra(${i},'cmd',1)" oncontextmenu="changeExtra(${i},'cmd',-1);return false;"><span>üëë</span>${p.cmd}</div>
                        <div class="counter-box" onclick="changeExtra(${i},'poison',1)" oncontextmenu="changeExtra(${i},'poison',-1);return false;"><span>‚ò£Ô∏è</span>${p.poison}</div>
                        <div class="counter-box" onclick="setMonarca(${i})"><span>‚òÄÔ∏è</span></div>
                    </div>
                </div>`).join('');
        }

        function updateName(i, val) { players[i].name = val.toUpperCase(); }
        function changeLife(i, v) {
            players[i].life += v;
            if (v === 10) play('plus10');
            else if (v === -10) play('minus10');
            else if (v > 0) play('plus1');
            else play('minus1');
            updateUI();
        }

        function changeExtra(i, type, v) {
            if (v > 0) play(type === 'cmd' ? 'cmd' : 'poison');
            else play('click');
            players[i][type] = Math.max(0, players[i][type] + v);
            updateUI();
        }

        function toggleDayNight() {
            isDay = !isDay;
            document.getElementById('day-night-toggle').innerText = isDay ? "‚òÄÔ∏è" : "üåï";
            play(isDay ? 'day' : 'night');
        }

        function changeMana(color, v) {
            mana[color] = Math.max(0, mana[color] + v);
            document.getElementById('m' + color).innerText = mana[color];
            if (v > 0) {
                const sounds = {
                    'w': 'mana_white', 'u': 'mana_blue', 'b': 'mana_black', 
                    'r': 'mana_red', 'g': 'mana_green', 'c': 'mana_colorless'
                };
                play(sounds[color]);
            } else play('click');
        }

        function changeStorm(v) { storm = Math.max(0, storm + v); document.getElementById('st-val').innerText = storm; play('click'); }
        function rollD20() { play('d20'); const res = Math.floor(Math.random() * 20) + 1; setTimeout(() => alert("Resultado: " + res), 100); }
        function setMonarca(i) { players.forEach((p, idx) => p.monarca = (idx === i && !p.monarca)); play('curar'); updateUI(); }
        function addPlayer() { if (players.length < 4) { players.push({ name: "JUGADOR " + (players.length + 1), life: 40, cmd: 0, poison: 0, monarca: false }); updateUI(); } }
        function removePlayer() { if (players.length > 1) { players.pop(); updateUI(); } }
        function play(s) { new Audio(s + '.mp3').play().catch(() => { }); }
        
        function resetGame() {
            if (confirm("¬øReiniciar?")) {
                sessionStorage.setItem('playReset', 'true');
                location.reload();
            }
        }

        updateUI();
        window.addEventListener('load', () => {
            if (sessionStorage.getItem('playReset') === 'true') {
                play('reset');
                sessionStorage.removeItem('playReset');
            }
        });
    </script>
</body>
</html>